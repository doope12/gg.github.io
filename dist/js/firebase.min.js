var casesOpenedText = document.querySelector("#casesopened"),
    battlesCreatedText = document.querySelector("#battlescreated"),
    upgradesText = document.querySelector("#upgrades"),
    jackpotsWonText = document.querySelector("#jackpotswon"),
    balanceText = document.querySelector("#balance"),
    firebaseConfig = {
        apiKey: "AIzaSyCP7rzxD9l0XifYfv30UjSEmQUIMu7xE0A",
        authDomain: "ggflip.firebaseapp.com",
        projectId: "ggflip",
        databaseURL: "https://ggflip-default-rtdb.firebaseio.com",
        storageBucket: "ggflip.firebasestorage.app",
        messagingSenderId: "1070621766174",
        appId: "1:1070621766174:web:9046b56cf7f2274f6cb40f",
        measurementId: "G-PWZ4FZ956H"
    },
    app = firebase.initializeApp(firebaseConfig),
    database = firebase.database(),
    casesRef = database.ref("caseopened"),
    battlesRef = database.ref("battlecreated"),
    upgraderRef = database.ref("upgrades"),
    jackpotRef = database.ref("jackpotwon"),
    balanceRef = database.ref("balance");

// Reading data from Firebase
casesRef.on("value", function(e) {
    e = e.val();
    casesOpenedText.textContent = e;
});
battlesRef.on("value", function(e) {
    e = e.val();
    battlesCreatedText.textContent = e;
});
upgraderRef.on("value", function(e) {
    e = e.val();
    upgradesText.textContent = e;
});
jackpotRef.on("value", function(e) {
    e = e.val();
    jackpotsWonText.textContent = e;
});

// Custom function to update Firebase whenever the balance is updated
function updateFirebaseBalance() {
    var balance = localStorage.getItem("Balance");
    if (balance) {
        balanceRef.set(balance);  // Update Firebase with the new balance
        balanceText.textContent = balance; // Optionally update the UI with the balance
    }
}

// Override localStorage.setItem to update Firebase whenever the balance is changed
(function() {
    const originalSetItem = localStorage.setItem;
    localStorage.setItem = function(key, value) {
        originalSetItem.apply(this, arguments);  // Call the original setItem
        if (key === "Balance") {
            updateFirebaseBalance();  // Update Firebase when "Balance" changes
        }
    };
})();

// Whenever the balance is updated, the localStorage event listener will trigger
// Example usage of setting the balance in localStorage:
function updateBalance(newBalance) {
    localStorage.setItem("Balance", newBalance);  // This will trigger Firebase update
}
